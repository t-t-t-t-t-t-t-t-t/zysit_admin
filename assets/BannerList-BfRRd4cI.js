import{b,d as y,E as h,_ as E,r as f,e as x,j as I,f as i,o as q,c as O,a as t,w as o,h as B}from"./index-DDjioiAb.js";import{U as R}from"./UploadImage-COppiFFJ.js";const A=(m="")=>m?b.get(`${y}/banner/bannerList/${m}`):b.get(`${y}/banner/bannerList`),F=({title:m,content:r,_id:l,type:e,image:p})=>b.put(`${y}/banner/bannerList`,{title:m,content:r,_id:l,type:e,image:p});function V(){return{getBannerList:(l="")=>A(l).then(e=>(h({message:e.msg,type:"success"}),e.data)).catch(e=>{console.log(e)}),putBanner:async({title:l,content:e,_id:p,type:g,image:d})=>{try{const u=await F({title:l,content:e,_id:p,type:g,image:d});return h({message:u.msg,type:"success"}),u.data}catch(u){console.log(u)}}}}const H={__name:"BannerList",setup(m){const r=f(),l=f([]),e=x({title:"",content:"",image:"",type:"",_id:null}),p=s=>{Object.assign(e,{image:s})},g=(s,n)=>{Object.assign(e,n,{index:s}),u()},d=f(!1),u=()=>{d.value=!d.value};I(()=>{V().getBannerList().then(s=>{l.value=s,l.value.length==0&&(l.value=[{title:"home",content:"home",type:"home",image:""},{title:"about",content:"about",type:"about",image:""},{title:"product",content:"product",type:"product",image:""},{title:"solution",content:"solution",type:"solution",image:""},{title:"cases",content:"cases",type:"cases",image:""},{title:"serve",content:"serve",type:"serve",image:""},{title:"news",content:"news",type:"news",image:""}])})});const L=x({title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!1,message:"请输入内容",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}]}),k=()=>{r.value.validate().then(s=>{s&&V().putBanner(e).then(n=>{Object.assign(l.value[e.index],{_id:e._id,title:e.title,content:e.content,type:e.type,image:e.image}),r.value&&(r.value.resetFields(),u())})}).catch(s=>{console.log(s)})};return(s,n)=>{const U=i("el-image"),c=i("el-table-column"),v=i("el-button"),$=i("el-table"),C=i("el-card"),w=i("el-input"),_=i("el-form-item"),j=i("el-form"),D=i("el-dialog");return q(),O("div",null,[t(C,{style:{width:"75%",position:"relative",left:"50%",transform:"translateX(-50%)"}},{default:o(()=>[t($,{data:l.value,style:{width:"100%"}},{default:o(()=>[t(c,{type:"expand"},{default:o(a=>[t(U,{style:{height:"100px"},src:a.row.image,fit:"contain"},null,8,["src"])]),_:1}),t(c,{prop:"type",label:"类型",width:"180"}),t(c,{prop:"title",label:"标题",width:"180"}),t(c,{prop:"content",label:"描述",width:"180"}),t(c,{fixed:"right",width:"180",label:"选项"},{default:o(a=>[t(v,{size:"small",onClick:M=>g(a.$index,a.row)},{default:o(()=>n[4]||(n[4]=[B(" 编辑 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(D,{modelValue:d.value,"onUpdate:modelValue":n[3]||(n[3]=a=>d.value=a),title:"编辑 "+e.type,width:"500"},{default:o(()=>[t(j,{model:e,ref_key:"formRef",ref:r,"label-width":"auto",rules:L,style:{"max-width":"600px"}},{default:o(()=>[t(_,{label:"标题",prop:"title"},{default:o(()=>[t(w,{style:{width:"280px"},modelValue:e.title,"onUpdate:modelValue":n[0]||(n[0]=a=>e.title=a)},null,8,["modelValue"])]),_:1}),t(_,{label:"内容",prop:"content"},{default:o(()=>[t(w,{style:{width:"280px"},modelValue:e.content,"onUpdate:modelValue":n[1]||(n[1]=a=>e.content=a)},null,8,["modelValue"])]),_:1}),t(_,{label:"图片",prop:"image"},{default:o(()=>[t(R,{image:e.image,onUploadImage:p},null,8,["image"])]),_:1}),t(v,{type:"primary",onClick:n[2]||(n[2]=a=>k())},{default:o(()=>n[5]||(n[5]=[B(" 编辑Banner ")])),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}},P=E(H,[["__scopeId","data-v-315dd91e"]]);export{P as default};
