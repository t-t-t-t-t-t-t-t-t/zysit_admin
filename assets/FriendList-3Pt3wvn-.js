import{b,d as D,E as $,r as x,e as C,f as d,o as h,g as L,w as n,a as t,h as w,i as V,j as I,c as R,k}from"./index-DDjioiAb.js";import{U as A}from"./UploadImage-COppiFFJ.js";const q=l=>l?b.get(`${D}/friend/friendList/${l}`):b.get(`${D}/friend/friendList`),z=({title:l,image:m})=>b.post(`${D}/friend/friendList`,{title:l,image:m}),H=({title:l,image:m,_id:p})=>b.put(`${D}/friend/friendList`,{title:l,image:m,_id:p}),M=l=>b.delete(`${D}/friend/friendList/${l}`);function B(){return{getFriendList:async(i="")=>{try{const a=await q(i);return $({message:a.msg,type:"success"}),a.data}catch(a){console.log(a)}},addFriend:async({title:i,image:a})=>{try{const g=await z({title:i,image:a});return $({message:g.msg,type:"success"}),g.data}catch(g){console.log(g)}},putFriend:async({_id:i,title:a,image:g})=>{try{const f=await H({_id:i,title:a,image:g});return $({message:f.msg,type:"success"}),f.data}catch(f){console.log(f)}},deleteFriend:async i=>{try{const a=await M(i);return $({message:a.msg,type:"success"}),a.data}catch(a){console.log(a)}}}}const N={__name:"FriendAdd",props:["isShowDialog"],emits:["addFriend","closeBox"],setup(l,{emit:m}){const p=m,u=x(),i=C({title:"",image:""}),a=C({title:[{required:!0,message:"请输入标题",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}]}),g=o=>{i.image=o},f=()=>{u.value.validate().then(o=>{o&&B().addFriend(i).then(s=>{p("addFriend",{_id:s._id,title:s.title,image:s.image}),p("closeBox"),u.value&&u.value.resetFields()})}).catch(o=>{console.log(o)})};return(o,s)=>{const r=d("el-input"),e=d("el-form-item"),c=d("el-button"),y=d("el-form"),v=d("el-dialog");return h(),L(v,{"model-value":l.isShowDialog,onSubmit:s[2]||(s[2]=V(()=>{},["prevent"])),title:"添加合作伙伴",width:"500",onClose:s[3]||(s[3]=F=>p("closeBox"))},{default:n(()=>[t(y,{model:i,ref_key:"formRed",ref:u,"label-width":"auto",rules:a,style:{"max-width":"600px"}},{default:n(()=>[t(e,{label:"标题",prop:"title"},{default:n(()=>[t(r,{style:{width:"280px"},modelValue:i.title,"onUpdate:modelValue":s[0]||(s[0]=F=>i.title=F)},null,8,["modelValue"])]),_:1}),t(e,{label:"图片",prop:"image"},{default:n(()=>[t(A,{image:i.image,onUploadImage:g},null,8,["image"])]),_:1}),t(c,{type:"primary",onClick:s[1]||(s[1]=F=>f())},{default:n(()=>s[4]||(s[4]=[w(" 添加合作伙伴 ")])),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}},j={__name:"FriendEdit",props:["isShowDialog","formData"],emits:["editFriend","closeBox"],setup(l,{emit:m}){const p=m,u=x(),i=C({title:[{required:!0,message:"请输入标题",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}]}),a=f=>{l.formData.image=f},g=()=>{u.value.validate().then(f=>{f&&B().putFriend(l.formData).then(o=>{p("editFriend",{_id:l.formData._id,title:l.formData.title,image:l.formData.image}),p("closeBox"),u.value&&u.value.resetFields()})}).catch(f=>{console.log(f)})};return(f,o)=>{const s=d("el-input"),r=d("el-form-item"),e=d("el-button"),c=d("el-form"),y=d("el-dialog");return h(),L(y,{"model-value":l.isShowDialog,onSubmit:o[2]||(o[2]=V(()=>{},["prevent"])),title:"编辑合作伙伴",width:"500",onClose:o[3]||(o[3]=v=>p("closeBox"))},{default:n(()=>[t(c,{model:l.formData,ref_key:"formRed",ref:u,"label-width":"auto",rules:i,style:{"max-width":"600px"}},{default:n(()=>[t(r,{label:"标题",prop:"title"},{default:n(()=>[t(s,{style:{width:"280px"},modelValue:l.formData.title,"onUpdate:modelValue":o[0]||(o[0]=v=>l.formData.title=v)},null,8,["modelValue"])]),_:1}),t(r,{label:"图片",prop:"image"},{default:n(()=>[t(A,{image:l.formData.image,onUploadImage:a},null,8,["image"])]),_:1}),t(e,{type:"primary",onClick:o[1]||(o[1]=v=>g())},{default:n(()=>o[4]||(o[4]=[w(" 确认编辑 ")])),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}},P={class:"card-header",style:{display:"flex","justify-content":"space-between"}},T={style:{"text-align":"center",margin:"0"}},K={__name:"FriendList",setup(l){const m=x([]),p=r=>{m.value.push(r)},u=x(!1),i=()=>{u.value=!u.value},a=(r,e)=>{B().deleteFriend(e._id).then(c=>{m.value.splice(r,1)})},g=x(0),f=(r,e)=>{g.value=r,o.value=!0},o=x(!1),s=r=>{m.value.splice(g.value,1,r)};return I(()=>{B().getFriendList().then(r=>{m.value=r})}),(r,e)=>{const c=d("el-button"),y=d("el-image"),v=d("el-table-column"),F=d("el-popover"),E=d("el-table"),U=d("el-card");return h(),R("div",null,[t(U,null,{header:n(()=>[k("div",P,[e[4]||(e[4]=k("span",null,"合作伙伴",-1)),t(c,{onClick:i},{default:n(()=>e[3]||(e[3]=[w("添加合作伙伴")])),_:1})])]),default:n(()=>[t(E,{data:m.value,style:{width:"100%"}},{default:n(()=>[t(v,{type:"expand"},{default:n(_=>[t(y,{style:{height:"100px"},src:_.row.image,fit:"contain"},null,8,["src"])]),_:1}),t(v,{prop:"title",label:"标题",width:"180"}),t(v,{fixed:"right",width:"180",label:"选项"},{default:n(_=>[t(c,{size:"small",onClick:S=>f(_.$index,_.row)},{default:n(()=>e[5]||(e[5]=[w(" 编辑 ")])),_:2},1032,["onClick"]),t(F,{trigger:"click",placement:"top",width:160},{reference:n(()=>[t(c,{size:"small",type:"danger"},{default:n(()=>e[8]||(e[8]=[w(" 删除 ")])),_:1})]),default:n(()=>[e[9]||(e[9]=k("p",{style:{"margin-bottom":"20px"}},"你确定要删除吗?",-1)),k("div",T,[t(c,{size:"small",onClick:e[0]||(e[0]=S=>r.popoverVisible=!1)},{default:n(()=>e[6]||(e[6]=[w("取消")])),_:1}),t(c,{size:"small",type:"primary",onClick:S=>a(_.$index,_.row)},{default:n(()=>e[7]||(e[7]=[w(" 确定 ")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),t(N,{onAddFriend:p,onCloseBox:e[1]||(e[1]=_=>u.value=!1),isShowDialog:u.value},null,8,["isShowDialog"]),t(j,{onEditFriend:s,onCloseBox:e[2]||(e[2]=_=>o.value=!1),isShowDialog:o.value,formData:m.value[g.value]},null,8,["isShowDialog","formData"])])}}};export{K as default};
