import{b as A,d as E,E as O,r as c,j as ee,e as z,f as g,o as d,g as D,w as l,a as e,c as I,F as L,l as S,k as h,h as U,t as G,q as J,s as Q,n as ae}from"./index-DDjioiAb.js";import{U as le}from"./UploadImage-COppiFFJ.js";import{u as te}from"./ProductCategoryHooks-BKJprlKG.js";const oe=t=>t?A.get(`${E}/product/productList/${t}`):A.get(`${E}/product/productList`),ue=({title:t,image:y,content:k,isXin:v,isHot:b,parameters:s,scene:i,category:p})=>A.post(`${E}/product/productList`,{title:t,image:y,content:k,isXin:v,isHot:b,parameters:s,scene:i,category:p}),ne=({_id:t,title:y,image:k,content:v,isXin:b,isHot:s,parameters:i,scene:p,category:w})=>A.put(`${E}/product/productList`,{_id:t,title:y,image:k,content:v,isXin:b,isHot:s,parameters:i,scene:p,category:w}),se=t=>A.delete(`${E}/product/productList/${t}`),re=()=>A.get(`${E}/product/productSolutionList`);function N(){return{getProductList:async(s="")=>{try{const i=await oe(s);return O({message:i.msg,type:"success"}),i.data}catch(i){console.log(i)}},addProduct:async({title:s,image:i,content:p,isXin:w,isHot:f,parameters:r,scene:V,category:H})=>{try{const P=await ue({title:s,image:i,content:p,isXin:w,isHot:f,parameters:r,scene:V,category:H});return O({message:P.msg,type:"success"}),P.data}catch(P){console.log(P)}},putProduct:async({_id:s,title:i,image:p,content:w,isXin:f,isHot:r,parameters:V,scene:H,category:P})=>{try{const $=await ne({_id:s,title:i,image:p,content:w,isXin:f,isHot:r,parameters:V,scene:H,category:P});return O({message:$.msg,type:"success"}),$.data}catch($){console.log($)}},deleteProduct:async s=>{try{const i=await se(s);return O({message:i.msg,type:"success"}),i.data}catch(i){console.log(i)}},getProductSolutionList:async()=>{try{const s=await re();return O({message:s.msg,type:"success"}),s.data}catch(s){console.log(s)}}}}const ie={class:"flex gap-2"},de={__name:"ProductAdd",props:["isShowDialog"],emits:["add","closeBox"],setup(t,{emit:y}){const k=y,v=c([]),b=c([]);ee(()=>{te().getProductCategoryList().then(n=>{b.value=n}),N().getProductSolutionList().then(n=>{v.value=n})});const s=z({key:"",value:""}),i=c(""),p=c(""),w=c(!1),f=c(!1),r=c(),V=c(),H=n=>{m.parameters.splice(m.parameters.indexOf(n),1)},P=()=>{w.value=!0,s.key="",s.value="",Q(()=>{r.value.input.focus()})},$=()=>{f.value=!0,Q(()=>{V.value.input.focus()})},B=()=>{i.value&&(s.key+=i.value,w.value=!1,i.value="",$())},_=()=>{p.value&&(s.value+=p.value,m.parameters.push({key:s.key,value:s.value}),s.key="",s.value="",f.value=!1,p.value="")},q=c(),m=z({category:z({}),title:"",image:"",content:"",isXin:!1,isHot:!1,parameters:[],scene:[]}),W=z({category:[{required:!0,message:"请选择类别",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}],content:[{required:!0,message:"请添加内容",trigger:"blur"}],isXin:[{required:!1,message:"请上传图片",trigger:"blur"}],isHot:[{required:!1,message:"请上传图片",trigger:"blur"}],parameters:[{required:!0,message:"请填写参数",trigger:"blur"}],scene:[{required:!0,message:"请增加场景",trigger:"blur"}]}),F=[{label:"是",value:!0},{label:"否",value:!1}],T=n=>{m.image=n},x=()=>{q.value.validate().then(n=>{n&&N().addProduct(m).then(a=>{k("add",{_id:a._id,title:a.title,image:a.image,content:a.content,isXin:a.isXin,isHot:a.isHot,parameters:a.parameters,scene:a.scene,category:a.category}),k("closeBox"),q.value&&q.value.resetFields()})}).catch(n=>{console.log(n)})};return(n,a)=>{const C=g("el-form-item"),K=g("el-input"),R=g("el-option"),X=g("el-select"),j=g("el-tag"),M=g("el-button"),Y=g("el-form"),u=g("el-dialog");return d(),D(u,{"model-value":t.isShowDialog,title:"添加产品",width:"500",onClose:a[9]||(a[9]=o=>k("closeBox"))},{default:l(()=>[e(Y,{model:m,ref_key:"formRed",ref:q,"label-width":"auto",rules:W,style:{"max-width":"600px"}},{default:l(()=>[e(C,{label:"图片",prop:"image"},{default:l(()=>[e(le,{image:m.image,onUploadImage:T},null,8,["image"])]),_:1}),e(C,{label:"标题",prop:"title"},{default:l(()=>[e(K,{style:{width:"280px"},modelValue:m.title,"onUpdate:modelValue":a[0]||(a[0]=o=>m.title=o)},null,8,["modelValue"])]),_:1}),e(C,{label:"类别",prop:"category"},{default:l(()=>[e(X,{modelValue:m.category,"onUpdate:modelValue":a[1]||(a[1]=o=>m.category=o)},{default:l(()=>[(d(!0),I(L,null,S(b.value,o=>(d(),D(R,{key:o._id,label:o.title,value:o.title},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"描述",prop:"content"},{default:l(()=>[e(K,{autosize:"",type:"textarea",style:{width:"280px"},modelValue:m.content,"onUpdate:modelValue":a[2]||(a[2]=o=>m.content=o)},null,8,["modelValue"])]),_:1}),e(C,{label:"参数",prop:"parameters"},{default:l(()=>[h("div",ie,[(d(!0),I(L,null,S(m.parameters,(o,Z)=>(d(),D(j,{key:Z,closable:"","disable-transitions":!1,style:{"margin-right":"5px"},onClose:ge=>H(o)},{default:l(()=>[U(G(o.key+":"+o.value),1)]),_:2},1032,["onClose"]))),128)),w.value?(d(),D(K,{key:0,ref_key:"InputKeyRef",ref:r,modelValue:i.value,"onUpdate:modelValue":a[3]||(a[3]=o=>i.value=o),placeholder:"请输入键",class:"w-20",size:"small",onKeyup:J(B,["enter"]),onBlur:B},null,8,["modelValue"])):f.value?(d(),D(K,{key:1,ref_key:"InputValueRef",ref:V,modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=o=>p.value=o),placeholder:"请输入值",class:"w-20",size:"small",onKeyup:J(_,["enter"]),onBlur:_},null,8,["modelValue"])):(d(),D(M,{key:2,class:"button-new-tag",size:"small",onClick:P},{default:l(()=>a[10]||(a[10]=[U(" + New Tag ")])),_:1}))])]),_:1}),e(C,{label:"是否Hot",prop:"isHot"},{default:l(()=>[e(X,{modelValue:m.isHot,"onUpdate:modelValue":a[5]||(a[5]=o=>m.isHot=o)},{default:l(()=>[(d(),I(L,null,S(F,o=>e(R,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"是否New",prop:"isXin"},{default:l(()=>[e(X,{modelValue:m.isXin,"onUpdate:modelValue":a[6]||(a[6]=o=>m.isXin=o)},{default:l(()=>[(d(),I(L,null,S(F,o=>e(R,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"应用场景",prop:"scene"},{default:l(()=>[e(X,{modelValue:m.scene,"onUpdate:modelValue":a[7]||(a[7]=o=>m.scene=o),"value-key":"_id",placeholder:"Select",style:{width:"240px"},clearable:"",multiple:""},{label:l(({label:o,value:Z})=>[h("span",null,G(o),1)]),default:l(()=>[(d(!0),I(L,null,S(v.value,o=>(d(),D(R,{key:o,label:o.title,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(M,{type:"primary",onClick:a[8]||(a[8]=o=>x())},{default:l(()=>a[11]||(a[11]=[U(" 确认添加 ")])),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}},me={class:"flex gap-2"},ce={__name:"ProductEdit",props:["isShowDialog","formData"],emits:["edit","closeBox"],setup(t,{emit:y}){const k=y,v=z({key:"",value:""}),b=c(""),s=c(""),i=c(!1),p=c(!1),w=c(),f=c(),r=x=>{t.formData.parameters.splice(t.formData.parameters.indexOf(x),1)},V=()=>{i.value=!0,v.key="",v.value="",Q(()=>{w.value.input.focus()})},H=()=>{p.value=!0,Q(()=>{f.value.input.focus()})},P=()=>{b.value&&(v.key+=b.value,H()),i.value=!1,b.value=""},$=()=>{s.value&&(v.value+=s.value,t.formData.parameters.push({key:v.key,value:v.value}),v.key="",v.value=""),p.value=!1,s.value=""},B=c(),_=z({category:[{required:!0,message:"请选择类别",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}],content:[{required:!0,message:"请添加内容",trigger:"blur"}],isXin:[{required:!1,message:"请上传图片",trigger:"blur"}],isHot:[{required:!1,message:"请上传图片",trigger:"blur"}],parameters:[{required:!0,message:"请填写参数",trigger:"blur"}],scene:[{required:!0,message:"请增加场景",trigger:"blur"}]}),q=[{label:"是",value:!0},{label:"否",value:!1}],m=x=>{t.formData.image=x},W=()=>{B.value.validate().then(x=>{x&&N().putProduct(t.formData).then(n=>{k("edit",{_id:t.formData._id,title:t.formData.title,image:t.formData.image,content:t.formData.content,isXin:t.formData.isXin,isHot:t.formData.isHot,parameters:t.formData.parameters,scene:t.formData.scene,category:t.formData.category}),k("closeBox"),B.value&&B.value.resetFields()})}).catch(x=>{console.log(x)})},F=c([]),T=c([]);return ee(()=>{te().getProductCategoryList().then(x=>{F.value=x}),N().getProductSolutionList().then(x=>{T.value=x})}),(x,n)=>{const a=g("el-form-item"),C=g("el-input"),K=g("el-option"),R=g("el-select"),X=g("el-tag"),j=g("el-button"),M=g("el-form"),Y=g("el-dialog");return d(),D(Y,{"model-value":t.isShowDialog,title:"编辑产品列表",width:"500",onClose:n[9]||(n[9]=u=>k("closeBox"))},{default:l(()=>[e(M,{model:t.formData,ref_key:"formRed",ref:B,"label-width":"auto",rules:_,style:{"max-width":"600px"}},{default:l(()=>[e(a,{label:"图片",prop:"image"},{default:l(()=>[e(le,{image:t.formData.image,onUploadImage:m},null,8,["image"])]),_:1}),e(a,{label:"标题",prop:"title"},{default:l(()=>[e(C,{style:{width:"280px"},modelValue:t.formData.title,"onUpdate:modelValue":n[0]||(n[0]=u=>t.formData.title=u)},null,8,["modelValue"])]),_:1}),e(a,{label:"类别",prop:"category"},{default:l(()=>[e(R,{modelValue:t.formData.category,"onUpdate:modelValue":n[1]||(n[1]=u=>t.formData.category=u)},{default:l(()=>[(d(!0),I(L,null,S(F.value,u=>(d(),D(K,{key:u._id,label:u.title,value:u.title},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"描述",prop:"content"},{default:l(()=>[e(C,{autosize:"",type:"textarea",style:{width:"280px"},modelValue:t.formData.content,"onUpdate:modelValue":n[2]||(n[2]=u=>t.formData.content=u)},null,8,["modelValue"])]),_:1}),e(a,{label:"参数",prop:"parameters"},{default:l(()=>[h("div",me,[(d(!0),I(L,null,S(t.formData.parameters,(u,o)=>(d(),D(X,{key:o,closable:"","disable-transitions":!1,style:{"margin-right":"5px"},onClose:Z=>r(u)},{default:l(()=>[U(G(u.key+":"+u.value),1)]),_:2},1032,["onClose"]))),128)),i.value?(d(),D(C,{key:0,ref_key:"InputKeyRef",ref:w,modelValue:b.value,"onUpdate:modelValue":n[3]||(n[3]=u=>b.value=u),placeholder:"请输入键",class:"w-20",size:"small",onKeyup:J(P,["enter"]),onBlur:P},null,8,["modelValue"])):ae("",!0),p.value?(d(),D(C,{key:1,ref_key:"InputValueRef",ref:f,modelValue:s.value,"onUpdate:modelValue":n[4]||(n[4]=u=>s.value=u),placeholder:"请输入值",class:"w-20",size:"small",onKeyup:J($,["enter"]),onBlur:$},null,8,["modelValue"])):(d(),D(j,{key:2,class:"button-new-tag",size:"small",onClick:V},{default:l(()=>n[10]||(n[10]=[U(" + New Tag ")])),_:1}))])]),_:1}),e(a,{label:"是否Hot",prop:"isHot"},{default:l(()=>[e(R,{modelValue:t.formData.isHot,"onUpdate:modelValue":n[5]||(n[5]=u=>t.formData.isHot=u)},{default:l(()=>[(d(),I(L,null,S(q,u=>e(K,{key:u.value,label:u.label,value:u.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"是否New",prop:"isXin"},{default:l(()=>[e(R,{modelValue:t.formData.isXin,"onUpdate:modelValue":n[6]||(n[6]=u=>t.formData.isXin=u)},{default:l(()=>[(d(),I(L,null,S(q,u=>e(K,{key:u.value,label:u.label,value:u.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"应用场景",prop:"scene"},{default:l(()=>[e(R,{modelValue:t.formData.scene,"onUpdate:modelValue":n[7]||(n[7]=u=>t.formData.scene=u),"value-key":"_id",placeholder:"Select",style:{width:"240px"},clearable:"",multiple:""},{label:l(({label:u,value:o})=>[h("span",null,G(u),1)]),default:l(()=>[(d(!0),I(L,null,S(T.value,u=>(d(),D(K,{key:u,label:u.title,value:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(j,{type:"primary",onClick:n[8]||(n[8]=u=>W())},{default:l(()=>n[11]||(n[11]=[U(" 确认编辑 ")])),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}},pe={class:"card-header",style:{display:"flex","justify-content":"space-between"}},fe={style:{"text-align":"center",margin:"0"}},Ve={__name:"ProductionList",setup(t){const y=c([]),k=f=>{y.value.push(f)},v=c(!1),b=(f,r)=>{N().deleteProduct(r._id).then(V=>{y.value.splice(f,1)})},s=c(0),i=(f,r)=>{s.value=f,p.value=!0},p=c(!1),w=f=>{y.value.splice(s.value,1,f)};return ee(()=>{N().getProductList().then(f=>{y.value=f})}),(f,r)=>{const V=g("el-button"),H=g("el-table-column"),P=g("el-popover"),$=g("el-table"),B=g("el-card");return d(),I("div",null,[e(B,null,{header:l(()=>[h("div",pe,[r[4]||(r[4]=h("span",null,"产品列表",-1)),e(V,{onClick:r[0]||(r[0]=_=>v.value=!0)},{default:l(()=>r[3]||(r[3]=[U("添加产品")])),_:1})])]),default:l(()=>[e($,{data:y.value,style:{width:"100%"}},{default:l(()=>[e(H,{prop:"title",label:"标题",width:"180"}),e(H,{fixed:"right",width:"180",label:"选项"},{default:l(_=>[e(V,{size:"small",onClick:q=>i(_.$index,_.row)},{default:l(()=>r[5]||(r[5]=[U(" 编辑 ")])),_:2},1032,["onClick"]),e(P,{trigger:"click",placement:"top",width:160},{reference:l(()=>[e(V,{size:"small",type:"danger"},{default:l(()=>r[8]||(r[8]=[U(" 删除 ")])),_:1})]),default:l(()=>[r[9]||(r[9]=h("p",{style:{"margin-bottom":"20px"}},"你确定要删除吗?",-1)),h("div",fe,[e(V,{size:"small"},{default:l(()=>r[6]||(r[6]=[U("取消")])),_:1}),e(V,{size:"small",type:"primary",onClick:q=>b(_.$index,_.row)},{default:l(()=>r[7]||(r[7]=[U(" 确定 ")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),e(de,{onAdd:k,onCloseBox:r[1]||(r[1]=_=>v.value=!1),isShowDialog:v.value},null,8,["isShowDialog"]),e(ce,{onEdit:w,onCloseBox:r[2]||(r[2]=_=>p.value=!1),isShowDialog:p.value,formData:y.value[s.value]},null,8,["isShowDialog","formData"])])}}};export{Ve as default};
