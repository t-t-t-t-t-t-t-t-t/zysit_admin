import{b as H,d as D,E as h,r as x,e as B,f as d,o as C,g as L,w as n,a as t,h as w,i as V,j as I,c as R,k as $}from"./index-DDjioiAb.js";import{U as A}from"./UploadImage-COppiFFJ.js";const q=o=>o?H.get(`${D}/honer/honerList/${o}`):H.get(`${D}/honer/honerList`),z=({title:o,image:m})=>H.post(`${D}/honer/honerList`,{title:o,image:m}),F=({title:o,image:m,_id:p})=>H.put(`${D}/honer/honerList`,{title:o,image:m,_id:p}),M=o=>H.delete(`${D}/honer/honerList/${o}`);function k(){return{getHonerList:async(s="")=>{try{const a=await q(s);return h({message:a.msg,type:"success"}),a.data}catch(a){console.log(a)}},addHoner:async({title:s,image:a})=>{try{const f=await z({title:s,image:a});return h({message:f.msg,type:"success"}),f.data}catch(f){console.log(f)}},putHoner:async({_id:s,title:a,image:f})=>{try{const g=await F({_id:s,title:a,image:f});return h({message:g.msg,type:"success"}),g.data}catch(g){console.log(g)}},deleteHoner:async s=>{try{const a=await M(s);return h({message:a.msg,type:"success"}),a.data}catch(a){console.log(a)}}}}const N={__name:"HonerAdd",props:["isShowDialog"],emits:["addHoner","closeBox"],setup(o,{emit:m}){const p=m,u=x(),s=B({title:"",image:""}),a=B({title:[{required:!0,message:"请输入标题",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}]}),f=l=>{s.image=l},g=()=>{u.value.validate().then(l=>{l&&k().addHoner(s).then(r=>{p("addHoner",{_id:r._id,title:r.title,image:r.image}),p("closeBox"),u.value&&u.value.resetFields()})}).catch(l=>{console.log(l)})};return(l,r)=>{const i=d("el-input"),e=d("el-form-item"),c=d("el-button"),y=d("el-form"),v=d("el-dialog");return C(),L(v,{"model-value":o.isShowDialog,onSubmit:r[2]||(r[2]=V(()=>{},["prevent"])),title:"添加荣誉",width:"500",onClose:r[3]||(r[3]=b=>p("closeBox"))},{default:n(()=>[t(y,{model:s,ref_key:"formRed",ref:u,"label-width":"auto",rules:a,style:{"max-width":"600px"}},{default:n(()=>[t(e,{label:"标题",prop:"title"},{default:n(()=>[t(i,{style:{width:"280px"},modelValue:s.title,"onUpdate:modelValue":r[0]||(r[0]=b=>s.title=b)},null,8,["modelValue"])]),_:1}),t(e,{label:"图片",prop:"image"},{default:n(()=>[t(A,{image:s.image,onUploadImage:f},null,8,["image"])]),_:1}),t(c,{type:"primary",onClick:r[1]||(r[1]=b=>g())},{default:n(()=>r[4]||(r[4]=[w(" 添加荣誉 ")])),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}},j={__name:"HonerEdit",props:["isShowDialog","formData"],emits:["editHoner","closeBox"],setup(o,{emit:m}){const p=m;console.log(o.formData);const u=x(),s=B({title:[{required:!0,message:"请输入标题",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}]}),a=g=>{o.formData.image=g},f=()=>{u.value.validate().then(g=>{g&&k().putHoner(o.formData).then(l=>{p("editHoner",{_id:o.formData._id,title:o.formData.title,image:o.formData.image}),p("closeBox"),u.value&&u.value.resetFields()})}).catch(g=>{console.log(g)})};return(g,l)=>{const r=d("el-input"),i=d("el-form-item"),e=d("el-button"),c=d("el-form"),y=d("el-dialog");return C(),L(y,{"model-value":o.isShowDialog,title:"添加荣誉",onSubmit:l[2]||(l[2]=V(()=>{},["prevent"])),width:"500",onClose:l[3]||(l[3]=v=>p("closeBox"))},{default:n(()=>[t(c,{model:o.formData,ref_key:"formRed",ref:u,"label-width":"auto",rules:s,style:{"max-width":"600px"}},{default:n(()=>[t(i,{label:"标题",prop:"title"},{default:n(()=>[t(r,{style:{width:"280px"},modelValue:o.formData.title,"onUpdate:modelValue":l[0]||(l[0]=v=>o.formData.title=v)},null,8,["modelValue"])]),_:1}),t(i,{label:"图片",prop:"image"},{default:n(()=>[t(A,{image:o.formData.image,onUploadImage:a},null,8,["image"])]),_:1}),t(e,{type:"primary",onClick:l[1]||(l[1]=v=>f())},{default:n(()=>l[4]||(l[4]=[w(" 确认编辑 ")])),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}},P={class:"card-header",style:{display:"flex","justify-content":"space-between"}},T={style:{"text-align":"center",margin:"0"}},K={__name:"HonerList",setup(o){const m=x([]),p=i=>{m.value.push(i)},u=x(!1),s=()=>{u.value=!u.value},a=(i,e)=>{k().deleteHoner(e._id).then(c=>{m.value.splice(i,1)})},f=x(0),g=(i,e)=>{f.value=i,l.value=!0},l=x(!1),r=i=>{m.value.splice(f.value,1,i)};return I(()=>{k().getHonerList().then(i=>{m.value=i})}),(i,e)=>{const c=d("el-button"),y=d("el-image"),v=d("el-table-column"),b=d("el-popover"),E=d("el-table"),U=d("el-card");return C(),R("div",null,[t(U,null,{header:n(()=>[$("div",P,[e[4]||(e[4]=$("span",null,"荣誉资质",-1)),t(c,{onClick:s},{default:n(()=>e[3]||(e[3]=[w("添加荣誉")])),_:1})])]),default:n(()=>[t(E,{data:m.value,style:{width:"100%"}},{default:n(()=>[t(v,{type:"expand"},{default:n(_=>[t(y,{style:{height:"100px"},src:_.row.image,fit:"fill"},null,8,["src"])]),_:1}),t(v,{prop:"title",label:"标题",width:"180"}),t(v,{fixed:"right",width:"180",label:"选项"},{default:n(_=>[t(c,{size:"small",onClick:S=>g(_.$index,_.row)},{default:n(()=>e[5]||(e[5]=[w(" 编辑 ")])),_:2},1032,["onClick"]),t(b,{trigger:"click",placement:"top",width:160},{reference:n(()=>[t(c,{size:"small",type:"danger"},{default:n(()=>e[8]||(e[8]=[w(" 删除 ")])),_:1})]),default:n(()=>[e[9]||(e[9]=$("p",{style:{"margin-bottom":"20px"}},"你确定要删除吗?",-1)),$("div",T,[t(c,{size:"small",onClick:e[0]||(e[0]=S=>i.popoverVisible=!1)},{default:n(()=>e[6]||(e[6]=[w("取消")])),_:1}),t(c,{size:"small",type:"primary",onClick:S=>a(_.$index,_.row)},{default:n(()=>e[7]||(e[7]=[w(" 确定 ")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),t(N,{onAddHoner:p,onCloseBox:e[1]||(e[1]=_=>u.value=!1),isShowDialog:u.value},null,8,["isShowDialog"]),t(j,{onEditHoner:r,onCloseBox:e[2]||(e[2]=_=>l.value=!1),isShowDialog:l.value,formData:m.value[f.value]},null,8,["isShowDialog","formData"])])}}};export{K as default};
